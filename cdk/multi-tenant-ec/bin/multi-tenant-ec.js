#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("source-map-support/register");
const cdk = require("aws-cdk-lib");
const global_stack_1 = require("../lib/global-stack");
const main_stack_1 = require("../lib/main-stack");
const app = new cdk.App();
const envName = app.node.tryGetContext("env");
if (!envName) {
    console.error("-cオプションでデプロイ先環境を指定してください。\n 例: cdk deploy -c env=<環境名>");
    process.exit(1);
}
// パラメータを取得
const params = getParams(envName);
// バージニアリージョン用のスタック
const globalStack = new global_stack_1.GlobalStack(app, `${envName}-MultiTenantGlobal`, params.globalStackProps);
// 東京リージョン用のスタック
new main_stack_1.MainStack(app, `${envName}-MultiTenantMain`, {
    ...params.mainStackProps,
    cloudFrontTenantCertificates: globalStack.cloudFrontTenantCertificates,
    cloudFrontWebAcl: globalStack.cloudFrontWebAcl,
});
function getParams(envName) {
    try {
        const params = require(`../params/${envName}`).params;
        return params;
    }
    catch (error) {
        console.error(`環境 "${envName}" のパラメータ読み込みに失敗しました:`, error);
        process.exit(1);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGktdGVuYW50LWVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibXVsdGktdGVuYW50LWVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLHVDQUFxQztBQUNyQyxtQ0FBbUM7QUFDbkMsc0RBQWtEO0FBQ2xELGtEQUE4QztBQUU5QyxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUUxQixNQUFNLE9BQU8sR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUU5QyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDYixPQUFPLENBQUMsS0FBSyxDQUNYLHdEQUF3RCxDQUN6RCxDQUFDO0lBQ0YsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNsQixDQUFDO0FBRUQsV0FBVztBQUNYLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUVsQyxtQkFBbUI7QUFDbkIsTUFBTSxXQUFXLEdBQUcsSUFBSSwwQkFBVyxDQUNqQyxHQUFHLEVBQ0gsR0FBRyxPQUFPLG9CQUFvQixFQUM5QixNQUFNLENBQUMsZ0JBQWdCLENBQ3hCLENBQUM7QUFFRixnQkFBZ0I7QUFDaEIsSUFBSSxzQkFBUyxDQUFDLEdBQUcsRUFBRSxHQUFHLE9BQU8sa0JBQWtCLEVBQUU7SUFDL0MsR0FBRyxNQUFNLENBQUMsY0FBYztJQUN4Qiw0QkFBNEIsRUFBRSxXQUFXLENBQUMsNEJBQTRCO0lBQ3RFLGdCQUFnQixFQUFFLFdBQVcsQ0FBQyxnQkFBZ0I7Q0FDL0MsQ0FBQyxDQUFDO0FBRUgsU0FBUyxTQUFTLENBQUMsT0FBZTtJQUNoQyxJQUFJLENBQUM7UUFDSCxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsYUFBYSxPQUFPLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQztRQUN0RCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNmLE9BQU8sQ0FBQyxLQUFLLENBQ1gsT0FBTyxPQUFPLHNCQUFzQixFQUNwQyxLQUFLLENBQ04sQ0FBQztRQUNGLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbEIsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIjIS91c3IvYmluL2VudiBub2RlXG5pbXBvcnQgXCJzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXJcIjtcbmltcG9ydCAqIGFzIGNkayBmcm9tIFwiYXdzLWNkay1saWJcIjtcbmltcG9ydCB7IEdsb2JhbFN0YWNrIH0gZnJvbSBcIi4uL2xpYi9nbG9iYWwtc3RhY2tcIjtcbmltcG9ydCB7IE1haW5TdGFjayB9IGZyb20gXCIuLi9saWIvbWFpbi1zdGFja1wiO1xuXG5jb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xuXG5jb25zdCBlbnZOYW1lID0gYXBwLm5vZGUudHJ5R2V0Q29udGV4dChcImVudlwiKTtcblxuaWYgKCFlbnZOYW1lKSB7XG4gIGNvbnNvbGUuZXJyb3IoXG4gICAgXCItY+OCquODl+OCt+ODp+ODs+OBp+ODh+ODl+ODreOCpOWFiOeSsOWig+OCkuaMh+WumuOBl+OBpuOBj+OBoOOBleOBhOOAglxcbiDkvos6IGNkayBkZXBsb3kgLWMgZW52PTznkrDlooPlkI0+XCIsXG4gICk7XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn1cblxuLy8g44OR44Op44Oh44O844K/44KS5Y+W5b6XXG5jb25zdCBwYXJhbXMgPSBnZXRQYXJhbXMoZW52TmFtZSk7XG5cbi8vIOODkOODvOOCuOODi+OCouODquODvOOCuOODp+ODs+eUqOOBruOCueOCv+ODg+OCr1xuY29uc3QgZ2xvYmFsU3RhY2sgPSBuZXcgR2xvYmFsU3RhY2soXG4gIGFwcCxcbiAgYCR7ZW52TmFtZX0tTXVsdGlUZW5hbnRHbG9iYWxgLFxuICBwYXJhbXMuZ2xvYmFsU3RhY2tQcm9wcyxcbik7XG5cbi8vIOadseS6rOODquODvOOCuOODp+ODs+eUqOOBruOCueOCv+ODg+OCr1xubmV3IE1haW5TdGFjayhhcHAsIGAke2Vudk5hbWV9LU11bHRpVGVuYW50TWFpbmAsIHtcbiAgLi4ucGFyYW1zLm1haW5TdGFja1Byb3BzLFxuICBjbG91ZEZyb250VGVuYW50Q2VydGlmaWNhdGVzOiBnbG9iYWxTdGFjay5jbG91ZEZyb250VGVuYW50Q2VydGlmaWNhdGVzLFxuICBjbG91ZEZyb250V2ViQWNsOiBnbG9iYWxTdGFjay5jbG91ZEZyb250V2ViQWNsLFxufSk7XG5cbmZ1bmN0aW9uIGdldFBhcmFtcyhlbnZOYW1lOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJhbXMgPSByZXF1aXJlKGAuLi9wYXJhbXMvJHtlbnZOYW1lfWApLnBhcmFtcztcbiAgICByZXR1cm4gcGFyYW1zO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICBg55Kw5aKDIFwiJHtlbnZOYW1lfVwiIOOBruODkeODqeODoeODvOOCv+iqreOBv+i+vOOBv+OBq+WkseaVl+OBl+OBvuOBl+OBnzpgLFxuICAgICAgZXJyb3IsXG4gICAgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn1cbiJdfQ==